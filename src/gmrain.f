      REAL FUNCTION GMRAIN(FREQ,T,RATE)

!        COMPUTES ATTENUATION OF CONDENSED WATER IN FORM OF RAIN

!        FREQ = WAVENUMBER (CM-1)
!        T    = TEMPERATURE (DEGREES KELVIN)
!        RATE = PRECIPITATION RATE (MM/HR)
!       WVLTH = WAVELENGTH IN CM

!     TABLES ATTAB AND FACTOR CALCULATED FROM FULL MIE THEORY
!     UTILIZING MARSHALL-PALMER SIZE DISTRIBUTION WITH RAYS INDEX
!     OF REFRACTION

!     ATTAB IS ATTENUATION DATA TABLE IN NEPERS FOR 20 DEG CELSIUS
!     WITH RADIATION FIELD REMOVED

!     WVNTBL IS WAVENUMBER TABLE FOR WAVENUMBERS USED IN TABLE ATTAB
!     TMPTAB IS INTERPOLATION DATA TABLE FOR TEMPERATURES IN DEG KELVIN

!     TFREQ IS INTERPOLATION DATA TABLE FOR WAVENUMBER IN CM-1

!     RATTAB IS RAIN RATE TABLE IN MM/HR

!     FACTOR IS TABLE OF TEMPERATURE CORRECTION FACTORS FOR
!     TABLE ATTAB FOR REPRESENTATIVE RAINS WITHOUT RADIATION FIELD
      IMPLICIT NONE

!     INPUT ARGUMENTS:
      REAL FREQ,T,RATE

!     LOCAL VARIABLES:
      INTEGER IWAV,ITMP,ITMPWV,I,ILOW,K,KMIN,J,KJ,ILOWP1,JLOW,JI
      REAL AITK,FAC,X(4),Y(4),ATTN(4),RATES(4)

!     DATA:
      REAL ATTAB(35,9),RATTAB(9),FACTOR(5,8,5)
      REAL TMPTAB(5),FACIT(5),TFACT(5)
      REAL TFREQ(8),WVNTBL(35)
      DATA WVNTBL/                                                      &
     &     .0000,    .0667,    .1000,    .1111,    .1250,    .1429,     &
     &     .1538,    .1667,    .1818,    .2000,    .2500,    .3333,     &
     &     .5000,   1.0000,   1.2500,   2.0000,   3.3333,   4.0000,     &
     &    5.0000,   6.6667,  10.0000,  13.3333,  16.6667,  20.0000,     &
     &   23.2558,  26.6667,  30.3030,  33.3333,  50.0000,  80.0000,     &
     &  120.0000, 180.0000, 250.0000, 300.0000, 350.0000/
      DATA (ATTAB(IWAV,1),IWAV=1,35)/                                   &
     & 1.272E+00,1.332E+00,1.361E+00,1.368E+00,1.393E+00,1.421E+00,     &
     & 1.439E+00,1.466E+00,1.499E+00,1.541E+00,1.682E+00,1.951E+00,     &
     & 2.571E+00,3.575E+00,3.808E+00,4.199E+00,3.665E+00,3.161E+00,     &
     & 2.462E+00,1.632E+00,8.203E-01,4.747E-01,3.052E-01,2.113E-01,     &
     & 1.551E-01,1.168E-01,8.958E-02,7.338E-02,3.174E-02,1.178E-02,     &
     & 5.016E-03,2.116E-03,1.123E-03,8.113E-04,6.260E-04/
      DATA (ATTAB(IWAV,2),IWAV=1,35)/                                   &
     & 4.915E+00,5.257E+00,5.518E+00,5.632E+00,5.807E+00,6.069E+00,     &
     & 6.224E+00,6.452E+00,6.756E+00,7.132E+00,8.453E+00,1.132E+01,     &
     & 1.685E+01,2.177E+01,2.246E+01,2.156E+01,1.470E+01,1.167E+01,     &
     & 8.333E+00,5.089E+00,2.356E+00,1.320E+00,8.315E-01,5.705E-01,     &
     & 4.151E-01,3.119E-01,2.385E-01,1.955E-01,8.373E-02,3.138E-02,     &
     & 1.351E-02,5.789E-03,3.090E-03,2.236E-03,1.725E-03/
      DATA (ATTAB(IWAV,3),IWAV=1,35)/                                   &
     & 8.798E+00,9.586E+00,1.023E+01,1.049E+01,1.093E+01,1.159E+01,     &
     & 1.205E+01,1.263E+01,1.343E+01,1.450E+01,1.832E+01,2.627E+01,     &
     & 3.904E+01,4.664E+01,4.702E+01,4.152E+01,2.542E+01,1.959E+01,     &
     & 1.363E+01,8.087E+00,3.660E+00,2.028E+00,1.274E+00,8.710E-01,     &
     & 6.340E-01,4.757E-01,3.634E-01,2.971E-01,1.275E-01,4.795E-02,     &
     & 2.072E-02,8.936E-03,4.780E-03,3.460E-03,2.670E-03/
      DATA (ATTAB(IWAV,4),IWAV=1,35)/                                   &
     & 1.575E+01,1.750E+01,1.914E+01,1.991E+01,2.108E+01,2.276E+01,     &
     & 2.399E+01,2.561E+01,2.785E+01,3.097E+01,4.204E+01,6.334E+01,     &
     & 8.971E+01,9.853E+01,9.609E+01,7.718E+01,4.290E+01,3.220E+01,     &
     & 2.188E+01,1.271E+01,5.641E+00,3.110E+00,1.947E+00,1.327E+00,     &
     & 9.657E-01,7.242E-01,5.539E-01,4.528E-01,1.942E-01,7.335E-02,     &
     & 3.181E-02,1.380E-02,7.394E-03,5.354E-03,4.132E-03/
      DATA (ATTAB(IWAV,5),IWAV=1,35)/                                   &
     & 3.400E+01,3.927E+01,4.523E+01,4.796E+01,5.207E+01,5.886E+01,     &
     & 6.383E+01,7.060E+01,8.005E+01,9.360E+01,1.381E+02,2.069E+02,     &
     & 2.620E+02,2.534E+02,2.366E+02,1.673E+02,8.285E+01,6.059E+01,     &
     & 4.013E+01,2.280E+01,9.939E+00,5.439E+00,3.400E+00,2.315E+00,     &
     & 1.685E+00,1.263E+00,9.664E-01,7.914E-01,3.397E-01,1.288E-01,     &
     & 5.611E-02,2.450E-02,1.316E-02,9.536E-03,7.360E-03/
      DATA (ATTAB(IWAV,6),IWAV=1,35)/                                   &
     & 6.087E+01,7.347E+01,8.886E+01,9.653E+01,1.081E+02,1.283E+02,     &
     & 1.435E+02,1.649E+02,1.947E+02,2.346E+02,3.543E+02,4.991E+02,     &
     & 5.705E+02,5.048E+02,4.510E+02,2.900E+02,1.335E+02,9.607E+01,     &
     & 6.269E+01,3.520E+01,1.519E+01,8.295E+00,5.182E+00,3.529E+00,     &
     & 2.569E+00,1.927E+00,1.474E+00,1.208E+00,5.191E-01,1.975E-01,     &
     & 8.627E-02,3.784E-02,2.037E-02,1.476E-02,1.139E-02/
      DATA (ATTAB(IWAV,7),IWAV=1,35)/                                   &
     & 1.090E+02,1.396E+02,1.811E+02,2.029E+02,2.396E+02,3.039E+02,     &
     & 3.536E+02,4.189E+02,5.081E+02,6.217E+02,9.038E+02,1.165E+03,     &
     & 1.212E+03,9.731E+02,8.330E+02,4.901E+02,2.123E+02,1.507E+02,     &
     & 9.718E+01,5.408E+01,2.316E+01,1.264E+01,7.896E+00,5.377E+00,     &
     & 3.915E+00,2.939E+00,2.249E+00,1.844E+00,7.940E-01,3.029E-01,     &
     & 1.327E-01,5.846E-02,3.151E-02,2.284E-02,1.763E-02/
      DATA (ATTAB(IWAV,8),IWAV=1,35)/                                   &
     & 1.950E+02,2.703E+02,3.904E+02,4.614E+02,5.825E+02,7.909E+02,     &
     & 9.475E+02,1.142E+03,1.380E+03,1.656E+03,2.237E+03,2.610E+03,     &
     & 2.500E+03,1.820E+03,1.491E+03,8.103E+02,3.336E+02,2.344E+02,     &
     & 1.495E+02,8.273E+01,3.524E+01,1.922E+01,1.203E+01,8.182E+00,     &
     & 5.961E+00,4.477E+00,3.429E+00,2.812E+00,1.216E+00,4.651E-01,     &
     & 2.043E-01,9.033E-02,4.874E-02,3.534E-02,2.728E-02/
      DATA (ATTAB(IWAV,9),IWAV=1,35)/                                   &
     & 2.742E+02,4.012E+02,6.353E+02,7.829E+02,1.027E+03,1.439E+03,     &
     & 1.725E+03,2.071E+03,2.475E+03,2.909E+03,3.738E+03,4.104E+03,     &
     & 3.776E+03,2.589E+03,2.070E+03,1.078E+03,4.326E+02,3.023E+02,     &
     & 1.918E+02,1.059E+02,4.499E+01,2.454E+01,1.539E+01,1.045E+01,     &
     & 7.615E+00,5.722E+00,4.384E+00,3.596E+00,1.561E+00,5.978E-01,     &
     & 2.630E-01,1.165E-01,6.292E-02,4.562E-02,3.522E-02/
      DATA RATTAB /.25,1.25,2.5,5.,12.5,25.,50.,100.,150./
      DATA TFREQ/0.0,0.1,0.3125,0.8,2.0,10.0,33.3333,350.0/
      DATA TMPTAB/273.15,283.15,293.15,303.15,313.15/
      DATA ((FACTOR(ITMP,ITMPWV,1),ITMP=1,5),ITMPWV=1,8)/               &
     & 1.606,1.252,1.000, .816, .680,1.603,1.246,1.000, .817, .684,     &
     & 1.444,1.207,1.000, .838, .694,1.016, .985,1.000,1.034,1.058,     &
     &  .950, .976,1.000,1.034,1.068, .922, .956,1.000,1.044,1.090,     &
     &  .932, .966,1.000,1.034,1.068, .957, .978,1.000,1.022,1.044/
      DATA ((FACTOR(ITMP,ITMPWV,2),ITMP=1,5),ITMPWV=1,8)/               &
     & 1.606,1.252,1.000, .816, .680,1.612,1.256,1.000, .817, .684,     &
     & 1.193,1.101,1.000, .889, .769, .885, .927,1.000,1.086,1.175,     &
     &  .941, .976,1.000,1.024,1.047, .932, .966,1.000,1.034,1.079,     &
     &  .932, .966,1.000,1.034,1.068, .957, .978,1.000,1.022,1.044/
      DATA ((FACTOR(ITMP,ITMPWV,3),ITMP=1,5),ITMPWV=1,8)/               &
     & 1.606,1.252,1.000, .816, .680,1.621,1.256,1.000, .817, .673,     &
     &  .969, .995,1.000, .982, .940, .895, .937,1.000,1.075,1.143,     &
     &  .950, .976,1.000,1.024,1.036, .932, .966,1.000,1.034,1.079,     &
     &  .932, .966,1.000,1.034,1.068, .957, .978,1.000,1.022,1.044/
      DATA ((FACTOR(ITMP,ITMPWV,4),ITMP=1,5),ITMPWV=1,8)/               &
     & 1.606,1.252,1.000, .816, .680,1.631,1.265,1.000, .807, .662,     &
     &  .848, .927,1.000,1.044,1.079, .922, .956,1.000,1.055,1.111,     &
     &  .950, .976,1.000,1.013,1.036, .932, .966,1.000,1.034,1.079,     &
     &  .932, .966,1.000,1.034,1.068, .957, .978,1.000,1.022,1.044/
      DATA ((FACTOR(ITMP,ITMPWV,5),ITMP=1,5),ITMPWV=1,8)/               &
     & 1.606,1.252,1.000, .816, .680,1.603,1.265,1.000, .807, .662,     &
     &  .820, .918,1.000,1.075,1.132, .941, .966,1.000,1.034,1.079,     &
     &  .960, .976,1.000,1.013,1.036, .932, .966,1.000,1.034,1.079,     &
     &  .932, .966,1.000,1.034,1.068, .957, .978,1.000,1.022,1.044/

!     GIVE ZERO ATTN IF RATE FALLS BELOW LIMIT
      GMRAIN=0.
      IF(RATE.LE..05)RETURN
      DO I=3,33
          IF(FREQ.LT.WVNTBL(I))GOTO 10
      ENDDO
      I=34
   10 CONTINUE
      ILOW=I-3
      DO K=3,7
          IF(RATE.LT.RATTAB(K))GOTO 20
      ENDDO
      K=8
   20 CONTINUE
      KMIN=K-3
      DO J=1,4
          X(J)=WVNTBL(ILOW+J)
      ENDDO

!     INTERPOLATE
      DO K=1,4
          KJ=KMIN+K
          RATES(K)=RATTAB(KJ)
          DO J=1,4
              Y(J)=LOG(ATTAB(ILOW+J,KJ))
          ENDDO
          ATTN(K)=EXP(AITK(X,Y,FREQ,4))
      ENDDO

!     APPLY TEMPERATURE CORRECTION
      ILOW=1
      DO ILOWP1=2,4
          IF(T.LT.TMPTAB(ILOWP1))GOTO 30
          ILOW=ILOWP1
      ENDDO
      ILOWP1=5
   30 CONTINUE
      DO J=2,7
          IF(FREQ.LT.TFREQ(J))GOTO 40
      ENDDO
      J=8
   40 CONTINUE
      JLOW=J-2
      DO K=1,2
          DO J=1,2

!             INTERPOLATE IN TEMPERATURE
              KJ=K+(KMIN+1)/2
              JI=JLOW+J
              FAC=((TMPTAB(ILOW)-T)*FACTOR(ILOWP1,JI,KJ)                &
     &           +(T-TMPTAB(ILOWP1))*FACTOR(ILOW,JI,KJ))                &
     &           /(TMPTAB(ILOW)-TMPTAB(ILOWP1))
              JI = JLOW +3-J
              FACIT(J) = (TFREQ(JI)-FREQ )*FAC
          ENDDO
          TFACT(K) = (FACIT(2)-FACIT(1))/(TFREQ(JLOW+1)-TFREQ(JLOW+2))
      ENDDO

!     COMPUTE ATTENUATION (DB/KM)
      KJ=2*((KMIN+1)/2)+1
      GMRAIN=AITK(RATES,ATTN,RATE,4)*                                   &
     &((RATE-RATTAB(KJ))*TFACT(2)+(RATTAB(KJ+2)-RATE)*                  &
     &TFACT(1))/(RATTAB(KJ+2)-RATTAB(KJ))
      RETURN
      END
